HloModule pmap_simulate_until_output.597

%jit__pad__4.30 (parameter.31: f32[1031,1024], parameter.32: s32[]) -> (f32[1032,1024]) {
  %constant.33 = pred[] constant(false)
  %parameter.31 = f32[1031,1024]{1,0} parameter(0)
  %parameter.32 = s32[] parameter(1)
  %broadcast.34 = s32[2,2]{1,0} broadcast(s32[] %parameter.32), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(2, 2) ]" source_file="wave_equation.py" source_line=109}
  %convert.35 = f32[2,2]{1,0} convert(s32[2,2]{1,0} %broadcast.34), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/convert_element_type[ new_dtype=float32\n                                                                                                                          weak_type=False ]" source_file="wave_equation.py" source_line=109}
  %constant.36 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.37 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.38 = pred[] compare(s32[] %constant.36, s32[] %constant.37), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.39 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.40 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.41 = s32[] add(s32[] %constant.39, s32[] %constant.40), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.42 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.43 = s32[] select(pred[] %compare.38, s32[] %add.41, s32[] %constant.42), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.52 = s32[1]{0} broadcast(s32[] %select.43), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.44 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.45 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.46 = pred[] compare(s32[] %constant.44, s32[] %constant.45), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.47 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.48 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.49 = s32[] add(s32[] %constant.47, s32[] %constant.48), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.50 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.51 = s32[] select(pred[] %compare.46, s32[] %add.49, s32[] %constant.50), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.53 = s32[1]{0} broadcast(s32[] %select.51), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.54 = s32[2]{0} concatenate(s32[1]{0} %broadcast.52, s32[1]{0} %broadcast.53), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.55 = f32[] gather(f32[2,2]{1,0} %convert.35, s32[2]{0} %concatenate.54), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.56 = f32[1031,1024]{1,0} pad(f32[1031,1024]{1,0} %parameter.31, f32[] %gather.55), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.57 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.58 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.59 = pred[] compare(s32[] %constant.57, s32[] %constant.58), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.60 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.61 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.62 = s32[] add(s32[] %constant.60, s32[] %constant.61), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.63 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.64 = s32[] select(pred[] %compare.59, s32[] %add.62, s32[] %constant.63), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.73 = s32[1]{0} broadcast(s32[] %select.64), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.65 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.66 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.67 = pred[] compare(s32[] %constant.65, s32[] %constant.66), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.68 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.69 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.70 = s32[] add(s32[] %constant.68, s32[] %constant.69), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.71 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.72 = s32[] select(pred[] %compare.67, s32[] %add.70, s32[] %constant.71), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.74 = s32[1]{0} broadcast(s32[] %select.72), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.75 = s32[2]{0} concatenate(s32[1]{0} %broadcast.73, s32[1]{0} %broadcast.74), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.76 = f32[] gather(f32[2,2]{1,0} %convert.35, s32[2]{0} %concatenate.75), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.77 = f32[1032,1024]{1,0} pad(f32[1031,1024]{1,0} %pad.56, f32[] %gather.76), padding=0_1x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 1, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.78 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.79 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.80 = pred[] compare(s32[] %constant.78, s32[] %constant.79), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.81 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.82 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.83 = s32[] add(s32[] %constant.81, s32[] %constant.82), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.84 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.85 = s32[] select(pred[] %compare.80, s32[] %add.83, s32[] %constant.84), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.94 = s32[1]{0} broadcast(s32[] %select.85), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.86 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.87 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.88 = pred[] compare(s32[] %constant.86, s32[] %constant.87), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.89 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.90 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.91 = s32[] add(s32[] %constant.89, s32[] %constant.90), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.92 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.93 = s32[] select(pred[] %compare.88, s32[] %add.91, s32[] %constant.92), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.95 = s32[1]{0} broadcast(s32[] %select.93), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.96 = s32[2]{0} concatenate(s32[1]{0} %broadcast.94, s32[1]{0} %broadcast.95), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.97 = f32[] gather(f32[2,2]{1,0} %convert.35, s32[2]{0} %concatenate.96), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.98 = f32[1032,1024]{1,0} pad(f32[1032,1024]{1,0} %pad.77, f32[] %gather.97), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.99 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.100 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.101 = pred[] compare(s32[] %constant.99, s32[] %constant.100), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.102 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.103 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.104 = s32[] add(s32[] %constant.102, s32[] %constant.103), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.105 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.106 = s32[] select(pred[] %compare.101, s32[] %add.104, s32[] %constant.105), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.115 = s32[1]{0} broadcast(s32[] %select.106), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.107 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.108 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.109 = pred[] compare(s32[] %constant.107, s32[] %constant.108), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.110 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.111 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.112 = s32[] add(s32[] %constant.110, s32[] %constant.111), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.113 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.114 = s32[] select(pred[] %compare.109, s32[] %add.112, s32[] %constant.113), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.116 = s32[1]{0} broadcast(s32[] %select.114), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.117 = s32[2]{0} concatenate(s32[1]{0} %broadcast.115, s32[1]{0} %broadcast.116), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.118 = f32[] gather(f32[2,2]{1,0} %convert.35, s32[2]{0} %concatenate.117), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.119 = f32[1032,1024]{1,0} pad(f32[1032,1024]{1,0} %pad.98, f32[] %gather.118), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  ROOT %tuple.120 = (f32[1032,1024]{1,0}) tuple(f32[1032,1024]{1,0} %pad.119)
}

%jit__pad__5.121 (parameter.122: f32[1031,1024], parameter.123: s32[]) -> (f32[1032,1024]) {
  %constant.124 = pred[] constant(false)
  %parameter.122 = f32[1031,1024]{1,0} parameter(0)
  %parameter.123 = s32[] parameter(1)
  %broadcast.125 = s32[2,2]{1,0} broadcast(s32[] %parameter.123), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(2, 2) ]" source_file="wave_equation.py" source_line=109}
  %convert.126 = f32[2,2]{1,0} convert(s32[2,2]{1,0} %broadcast.125), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/convert_element_type[ new_dtype=float32\n                                                                                                                          weak_type=False ]" source_file="wave_equation.py" source_line=109}
  %constant.127 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.128 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.129 = pred[] compare(s32[] %constant.127, s32[] %constant.128), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.130 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.131 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.132 = s32[] add(s32[] %constant.130, s32[] %constant.131), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.133 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.134 = s32[] select(pred[] %compare.129, s32[] %add.132, s32[] %constant.133), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.143 = s32[1]{0} broadcast(s32[] %select.134), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.135 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.136 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.137 = pred[] compare(s32[] %constant.135, s32[] %constant.136), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.138 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.139 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.140 = s32[] add(s32[] %constant.138, s32[] %constant.139), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.141 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.142 = s32[] select(pred[] %compare.137, s32[] %add.140, s32[] %constant.141), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.144 = s32[1]{0} broadcast(s32[] %select.142), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.145 = s32[2]{0} concatenate(s32[1]{0} %broadcast.143, s32[1]{0} %broadcast.144), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.146 = f32[] gather(f32[2,2]{1,0} %convert.126, s32[2]{0} %concatenate.145), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.147 = f32[1032,1024]{1,0} pad(f32[1031,1024]{1,0} %parameter.122, f32[] %gather.146), padding=1_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((1, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.148 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.149 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.150 = pred[] compare(s32[] %constant.148, s32[] %constant.149), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.151 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.152 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.153 = s32[] add(s32[] %constant.151, s32[] %constant.152), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.154 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.155 = s32[] select(pred[] %compare.150, s32[] %add.153, s32[] %constant.154), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.164 = s32[1]{0} broadcast(s32[] %select.155), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.156 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.157 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.158 = pred[] compare(s32[] %constant.156, s32[] %constant.157), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.159 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.160 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.161 = s32[] add(s32[] %constant.159, s32[] %constant.160), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.162 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.163 = s32[] select(pred[] %compare.158, s32[] %add.161, s32[] %constant.162), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.165 = s32[1]{0} broadcast(s32[] %select.163), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.166 = s32[2]{0} concatenate(s32[1]{0} %broadcast.164, s32[1]{0} %broadcast.165), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.167 = f32[] gather(f32[2,2]{1,0} %convert.126, s32[2]{0} %concatenate.166), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.168 = f32[1032,1024]{1,0} pad(f32[1032,1024]{1,0} %pad.147, f32[] %gather.167), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.169 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.170 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.171 = pred[] compare(s32[] %constant.169, s32[] %constant.170), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.172 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.173 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.174 = s32[] add(s32[] %constant.172, s32[] %constant.173), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.175 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.176 = s32[] select(pred[] %compare.171, s32[] %add.174, s32[] %constant.175), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.185 = s32[1]{0} broadcast(s32[] %select.176), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.177 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.178 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.179 = pred[] compare(s32[] %constant.177, s32[] %constant.178), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.180 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.181 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.182 = s32[] add(s32[] %constant.180, s32[] %constant.181), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.183 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.184 = s32[] select(pred[] %compare.179, s32[] %add.182, s32[] %constant.183), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.186 = s32[1]{0} broadcast(s32[] %select.184), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.187 = s32[2]{0} concatenate(s32[1]{0} %broadcast.185, s32[1]{0} %broadcast.186), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.188 = f32[] gather(f32[2,2]{1,0} %convert.126, s32[2]{0} %concatenate.187), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.189 = f32[1032,1024]{1,0} pad(f32[1032,1024]{1,0} %pad.168, f32[] %gather.188), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.190 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.191 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.192 = pred[] compare(s32[] %constant.190, s32[] %constant.191), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.193 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.194 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.195 = s32[] add(s32[] %constant.193, s32[] %constant.194), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.196 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.197 = s32[] select(pred[] %compare.192, s32[] %add.195, s32[] %constant.196), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.206 = s32[1]{0} broadcast(s32[] %select.197), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.198 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.199 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.200 = pred[] compare(s32[] %constant.198, s32[] %constant.199), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.201 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.202 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.203 = s32[] add(s32[] %constant.201, s32[] %constant.202), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.204 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.205 = s32[] select(pred[] %compare.200, s32[] %add.203, s32[] %constant.204), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.207 = s32[1]{0} broadcast(s32[] %select.205), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.208 = s32[2]{0} concatenate(s32[1]{0} %broadcast.206, s32[1]{0} %broadcast.207), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.209 = f32[] gather(f32[2,2]{1,0} %convert.126, s32[2]{0} %concatenate.208), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.210 = f32[1032,1024]{1,0} pad(f32[1032,1024]{1,0} %pad.189, f32[] %gather.209), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  ROOT %tuple.211 = (f32[1032,1024]{1,0}) tuple(f32[1032,1024]{1,0} %pad.210)
}

%jit__pad__6.212 (parameter.213: f32[1032,1023], parameter.214: s32[]) -> (f32[1032,1024]) {
  %constant.215 = pred[] constant(false)
  %parameter.213 = f32[1032,1023]{1,0} parameter(0)
  %parameter.214 = s32[] parameter(1)
  %broadcast.216 = s32[2,2]{1,0} broadcast(s32[] %parameter.214), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(2, 2) ]" source_file="wave_equation.py" source_line=109}
  %convert.217 = f32[2,2]{1,0} convert(s32[2,2]{1,0} %broadcast.216), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/convert_element_type[ new_dtype=float32\n                                                                                                                          weak_type=False ]" source_file="wave_equation.py" source_line=109}
  %constant.218 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.219 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.220 = pred[] compare(s32[] %constant.218, s32[] %constant.219), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.221 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.222 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.223 = s32[] add(s32[] %constant.221, s32[] %constant.222), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.224 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.225 = s32[] select(pred[] %compare.220, s32[] %add.223, s32[] %constant.224), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.234 = s32[1]{0} broadcast(s32[] %select.225), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.226 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.227 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.228 = pred[] compare(s32[] %constant.226, s32[] %constant.227), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.229 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.230 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.231 = s32[] add(s32[] %constant.229, s32[] %constant.230), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.232 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.233 = s32[] select(pred[] %compare.228, s32[] %add.231, s32[] %constant.232), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.235 = s32[1]{0} broadcast(s32[] %select.233), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.236 = s32[2]{0} concatenate(s32[1]{0} %broadcast.234, s32[1]{0} %broadcast.235), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.237 = f32[] gather(f32[2,2]{1,0} %convert.217, s32[2]{0} %concatenate.236), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.238 = f32[1032,1023]{1,0} pad(f32[1032,1023]{1,0} %parameter.213, f32[] %gather.237), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.239 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.240 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.241 = pred[] compare(s32[] %constant.239, s32[] %constant.240), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.242 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.243 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.244 = s32[] add(s32[] %constant.242, s32[] %constant.243), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.245 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.246 = s32[] select(pred[] %compare.241, s32[] %add.244, s32[] %constant.245), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.255 = s32[1]{0} broadcast(s32[] %select.246), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.247 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.248 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.249 = pred[] compare(s32[] %constant.247, s32[] %constant.248), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.250 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.251 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.252 = s32[] add(s32[] %constant.250, s32[] %constant.251), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.253 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.254 = s32[] select(pred[] %compare.249, s32[] %add.252, s32[] %constant.253), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.256 = s32[1]{0} broadcast(s32[] %select.254), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.257 = s32[2]{0} concatenate(s32[1]{0} %broadcast.255, s32[1]{0} %broadcast.256), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.258 = f32[] gather(f32[2,2]{1,0} %convert.217, s32[2]{0} %concatenate.257), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.259 = f32[1032,1023]{1,0} pad(f32[1032,1023]{1,0} %pad.238, f32[] %gather.258), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.260 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.261 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.262 = pred[] compare(s32[] %constant.260, s32[] %constant.261), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.263 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.264 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.265 = s32[] add(s32[] %constant.263, s32[] %constant.264), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.266 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.267 = s32[] select(pred[] %compare.262, s32[] %add.265, s32[] %constant.266), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.276 = s32[1]{0} broadcast(s32[] %select.267), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.268 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.269 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.270 = pred[] compare(s32[] %constant.268, s32[] %constant.269), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.271 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.272 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.273 = s32[] add(s32[] %constant.271, s32[] %constant.272), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.274 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.275 = s32[] select(pred[] %compare.270, s32[] %add.273, s32[] %constant.274), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.277 = s32[1]{0} broadcast(s32[] %select.275), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.278 = s32[2]{0} concatenate(s32[1]{0} %broadcast.276, s32[1]{0} %broadcast.277), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.279 = f32[] gather(f32[2,2]{1,0} %convert.217, s32[2]{0} %concatenate.278), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.280 = f32[1032,1023]{1,0} pad(f32[1032,1023]{1,0} %pad.259, f32[] %gather.279), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.281 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.282 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.283 = pred[] compare(s32[] %constant.281, s32[] %constant.282), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.284 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.285 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.286 = s32[] add(s32[] %constant.284, s32[] %constant.285), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.287 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.288 = s32[] select(pred[] %compare.283, s32[] %add.286, s32[] %constant.287), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.297 = s32[1]{0} broadcast(s32[] %select.288), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.289 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.290 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.291 = pred[] compare(s32[] %constant.289, s32[] %constant.290), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.292 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.293 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.294 = s32[] add(s32[] %constant.292, s32[] %constant.293), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.295 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.296 = s32[] select(pred[] %compare.291, s32[] %add.294, s32[] %constant.295), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.298 = s32[1]{0} broadcast(s32[] %select.296), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.299 = s32[2]{0} concatenate(s32[1]{0} %broadcast.297, s32[1]{0} %broadcast.298), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.300 = f32[] gather(f32[2,2]{1,0} %convert.217, s32[2]{0} %concatenate.299), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.301 = f32[1032,1024]{1,0} pad(f32[1032,1023]{1,0} %pad.280, f32[] %gather.300), padding=0_0x0_1, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 1, 0)) ]" source_file="wave_equation.py" source_line=109}
  ROOT %tuple.302 = (f32[1032,1024]{1,0}) tuple(f32[1032,1024]{1,0} %pad.301)
}

%jit__pad__7.303 (parameter.304: f32[1032,1023], parameter.305: s32[]) -> (f32[1032,1024]) {
  %constant.306 = pred[] constant(false)
  %parameter.304 = f32[1032,1023]{1,0} parameter(0)
  %parameter.305 = s32[] parameter(1)
  %broadcast.307 = s32[2,2]{1,0} broadcast(s32[] %parameter.305), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(2, 2) ]" source_file="wave_equation.py" source_line=109}
  %convert.308 = f32[2,2]{1,0} convert(s32[2,2]{1,0} %broadcast.307), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/convert_element_type[ new_dtype=float32\n                                                                                                                          weak_type=False ]" source_file="wave_equation.py" source_line=109}
  %constant.309 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.310 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.311 = pred[] compare(s32[] %constant.309, s32[] %constant.310), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.312 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.313 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.314 = s32[] add(s32[] %constant.312, s32[] %constant.313), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.315 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.316 = s32[] select(pred[] %compare.311, s32[] %add.314, s32[] %constant.315), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.325 = s32[1]{0} broadcast(s32[] %select.316), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.317 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.318 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.319 = pred[] compare(s32[] %constant.317, s32[] %constant.318), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.320 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.321 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.322 = s32[] add(s32[] %constant.320, s32[] %constant.321), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.323 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.324 = s32[] select(pred[] %compare.319, s32[] %add.322, s32[] %constant.323), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.326 = s32[1]{0} broadcast(s32[] %select.324), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.327 = s32[2]{0} concatenate(s32[1]{0} %broadcast.325, s32[1]{0} %broadcast.326), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.328 = f32[] gather(f32[2,2]{1,0} %convert.308, s32[2]{0} %concatenate.327), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.329 = f32[1032,1023]{1,0} pad(f32[1032,1023]{1,0} %parameter.304, f32[] %gather.328), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.330 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.331 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.332 = pred[] compare(s32[] %constant.330, s32[] %constant.331), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.333 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.334 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.335 = s32[] add(s32[] %constant.333, s32[] %constant.334), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.336 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.337 = s32[] select(pred[] %compare.332, s32[] %add.335, s32[] %constant.336), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.346 = s32[1]{0} broadcast(s32[] %select.337), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.338 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.339 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.340 = pred[] compare(s32[] %constant.338, s32[] %constant.339), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.341 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.342 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.343 = s32[] add(s32[] %constant.341, s32[] %constant.342), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.344 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.345 = s32[] select(pred[] %compare.340, s32[] %add.343, s32[] %constant.344), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.347 = s32[1]{0} broadcast(s32[] %select.345), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.348 = s32[2]{0} concatenate(s32[1]{0} %broadcast.346, s32[1]{0} %broadcast.347), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.349 = f32[] gather(f32[2,2]{1,0} %convert.308, s32[2]{0} %concatenate.348), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.350 = f32[1032,1023]{1,0} pad(f32[1032,1023]{1,0} %pad.329, f32[] %gather.349), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.351 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.352 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.353 = pred[] compare(s32[] %constant.351, s32[] %constant.352), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.354 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.355 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.356 = s32[] add(s32[] %constant.354, s32[] %constant.355), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.357 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.358 = s32[] select(pred[] %compare.353, s32[] %add.356, s32[] %constant.357), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.367 = s32[1]{0} broadcast(s32[] %select.358), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.359 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.360 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.361 = pred[] compare(s32[] %constant.359, s32[] %constant.360), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.362 = s32[] constant(0), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.363 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.364 = s32[] add(s32[] %constant.362, s32[] %constant.363), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.365 = s32[] constant(0), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.366 = s32[] select(pred[] %compare.361, s32[] %add.364, s32[] %constant.365), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.368 = s32[1]{0} broadcast(s32[] %select.366), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.369 = s32[2]{0} concatenate(s32[1]{0} %broadcast.367, s32[1]{0} %broadcast.368), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.370 = f32[] gather(f32[2,2]{1,0} %convert.308, s32[2]{0} %concatenate.369), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.371 = f32[1032,1024]{1,0} pad(f32[1032,1023]{1,0} %pad.350, f32[] %gather.370), padding=0_0x1_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (1, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  %constant.372 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.373 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.374 = pred[] compare(s32[] %constant.372, s32[] %constant.373), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.375 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.376 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.377 = s32[] add(s32[] %constant.375, s32[] %constant.376), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.378 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.379 = s32[] select(pred[] %compare.374, s32[] %add.377, s32[] %constant.378), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.388 = s32[1]{0} broadcast(s32[] %select.379), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %constant.380 = s32[] constant(1), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.381 = s32[] constant(0), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %compare.382 = pred[] compare(s32[] %constant.380, s32[] %constant.381), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/lt" source_file="wave_equation.py" source_line=109}
  %constant.383 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.384 = s32[] constant(2), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %add.385 = s32[] add(s32[] %constant.383, s32[] %constant.384), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/add" source_file="wave_equation.py" source_line=109}
  %constant.386 = s32[] constant(1), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %select.387 = s32[] select(pred[] %compare.382, s32[] %add.385, s32[] %constant.386), metadata={op_type="select" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/select" source_file="wave_equation.py" source_line=109}
  %broadcast.389 = s32[1]{0} broadcast(s32[] %select.387), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                                      shape=(1,) ]" source_file="wave_equation.py" source_line=109}
  %concatenate.390 = s32[2]{0} concatenate(s32[1]{0} %broadcast.388, s32[1]{0} %broadcast.389), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=109}
  %gather.391 = f32[] gather(f32[2,2]{1,0} %convert.308, s32[2]{0} %concatenate.390), offset_dims={}, collapsed_slice_dims={0,1}, start_index_map={0,1}, index_vector_dim=0, slice_sizes={1,1}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(), collapsed_slice_dims=(0, 1), start_index_map=(0, 1))\n                                                                                                            indices_are_sorted=True\n                                                                                                            slice_sizes=(1, 1)\n                                                                                                            unique_indices=True ]" source_file="wave_equation.py" source_line=109}
  %pad.392 = f32[1032,1024]{1,0} pad(f32[1032,1024]{1,0} %pad.371, f32[] %gather.391), padding=0_0x0_0, metadata={op_type="pad" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/jit(_pad)/pad[ padding_config=((0, 0, 0), (0, 0, 0)) ]" source_file="wave_equation.py" source_line=109}
  ROOT %tuple.393 = (f32[1032,1024]{1,0}) tuple(f32[1032,1024]{1,0} %pad.392)
}

%jit_leapfrog_step__1.394 (parameter.395: f32[1032,1024], parameter.396: f32[1032,1024], parameter.397: f32[], parameter.398: s32[]) -> (f32[1032,1024], f32[1032,1024]) {
  %constant.399 = pred[] constant(false)
  %parameter.395 = f32[1032,1024]{1,0} parameter(0)
  %parameter.396 = f32[1032,1024]{1,0} parameter(1)
  %parameter.398 = s32[] parameter(3)
  %multiply.400 = s32[] multiply(s32[] %parameter.398, s32[] %parameter.398), metadata={op_type="integer_pow" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/integer_pow[ y=2 ]" source_file="wave_equation.py" source_line=122}
  %convert.436 = f32[] convert(s32[] %multiply.400), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/convert_element_type[ new_dtype=float32\n                                                                                                                weak_type=False ]" source_file="wave_equation.py" source_line=122}
  %broadcast.437 = f32[1032,1024]{1,0} broadcast(f32[] %convert.436), dimensions={}, metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=122}
  %constant.401 = s32[] constant(1), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.402 = s32[1]{0} broadcast(s32[] %constant.401), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.403 = f32[1031,1024]{1,0} gather(f32[1032,1024]{1,0} %parameter.395, s32[1]{0} %broadcast.402), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={1031,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                                                                                  indices_are_sorted=True\n                                                                                                  slice_sizes=(1031, 1024)\n                                                                                                  unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.404 = f32[1031,1024]{1,0} broadcast(f32[1031,1024]{1,0} %gather.403), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                                                                            shape=(1031, 1024) ]" source_file="wave_equation.py" source_line=43}
  %constant.405 = s32[] constant(0), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %call.406 = (f32[1032,1024]{1,0}) call(f32[1031,1024]{1,0} %broadcast.404, s32[] %constant.405), to_apply=%jit__pad__4.30, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %get-tuple-element.407 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}) %call.406), index=0, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %constant.408 = s32[] constant(0), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.409 = s32[1]{0} broadcast(s32[] %constant.408), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.410 = f32[1031,1024]{1,0} gather(f32[1032,1024]{1,0} %parameter.395, s32[1]{0} %broadcast.409), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={1031,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                                                                                  indices_are_sorted=True\n                                                                                                  slice_sizes=(1031, 1024)\n                                                                                                  unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.411 = f32[1031,1024]{1,0} broadcast(f32[1031,1024]{1,0} %gather.410), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                                                                            shape=(1031, 1024) ]" source_file="wave_equation.py" source_line=43}
  %constant.412 = s32[] constant(0), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %call.413 = (f32[1032,1024]{1,0}) call(f32[1031,1024]{1,0} %broadcast.411, s32[] %constant.412), to_apply=%jit__pad__5.121, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %get-tuple-element.414 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}) %call.413), index=0, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %add.429 = f32[1032,1024]{1,0} add(f32[1032,1024]{1,0} %get-tuple-element.407, f32[1032,1024]{1,0} %get-tuple-element.414), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/add" source_file="wave_equation.py" source_line=116}
  %constant.415 = s32[] constant(1), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.416 = s32[1]{0} broadcast(s32[] %constant.415), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.417 = f32[1032,1023]{1,0} gather(f32[1032,1024]{1,0} %parameter.395, s32[1]{0} %broadcast.416), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={1}, index_vector_dim=0, slice_sizes={1032,1023}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(1,))\n                                                                                                  indices_are_sorted=True\n                                                                                                  slice_sizes=(1032, 1023)\n                                                                                                  unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.418 = f32[1032,1023]{1,0} broadcast(f32[1032,1023]{1,0} %gather.417), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                                                                            shape=(1032, 1023) ]" source_file="wave_equation.py" source_line=43}
  %constant.419 = s32[] constant(0), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %call.420 = (f32[1032,1024]{1,0}) call(f32[1032,1023]{1,0} %broadcast.418, s32[] %constant.419), to_apply=%jit__pad__6.212, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %get-tuple-element.421 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}) %call.420), index=0, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %add.430 = f32[1032,1024]{1,0} add(f32[1032,1024]{1,0} %add.429, f32[1032,1024]{1,0} %get-tuple-element.421), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/add" source_file="wave_equation.py" source_line=116}
  %constant.422 = s32[] constant(0), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.423 = s32[1]{0} broadcast(s32[] %constant.422), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                                                                            shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.424 = f32[1032,1023]{1,0} gather(f32[1032,1024]{1,0} %parameter.395, s32[1]{0} %broadcast.423), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={1}, index_vector_dim=0, slice_sizes={1032,1023}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(1,))\n                                                                                                  indices_are_sorted=True\n                                                                                                  slice_sizes=(1032, 1023)\n                                                                                                  unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.425 = f32[1032,1023]{1,0} broadcast(f32[1032,1023]{1,0} %gather.424), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                                                                            shape=(1032, 1023) ]" source_file="wave_equation.py" source_line=43}
  %constant.426 = s32[] constant(0), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %call.427 = (f32[1032,1024]{1,0}) call(f32[1032,1023]{1,0} %broadcast.425, s32[] %constant.426), to_apply=%jit__pad__7.303, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %get-tuple-element.428 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}) %call.427), index=0, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/xla_call[ backend=None\n                                                                                                    device=None\n                                                                                                    donated_invars=(False, False)\n                                                                                                    inline=False\n                                                                                                    name=_pad ]" source_file="wave_equation.py" source_line=109}
  %add.431 = f32[1032,1024]{1,0} add(f32[1032,1024]{1,0} %add.430, f32[1032,1024]{1,0} %get-tuple-element.428), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/add" source_file="wave_equation.py" source_line=116}
  %constant.432 = f32[] constant(4), metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=116}
  %broadcast.433 = f32[1032,1024]{1,0} broadcast(f32[] %constant.432), dimensions={}, metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=116}
  %multiply.434 = f32[1032,1024]{1,0} multiply(f32[1032,1024]{1,0} %parameter.395, f32[1032,1024]{1,0} %broadcast.433), metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=116}
  %subtract.435 = f32[1032,1024]{1,0} subtract(f32[1032,1024]{1,0} %add.431, f32[1032,1024]{1,0} %multiply.434), metadata={op_type="sub" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/sub" source_file="wave_equation.py" source_line=116}
  %multiply.438 = f32[1032,1024]{1,0} multiply(f32[1032,1024]{1,0} %broadcast.437, f32[1032,1024]{1,0} %subtract.435), metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=122}
  %parameter.397 = f32[] parameter(2)
  %convert.439 = f32[] convert(f32[] %parameter.397), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/convert_element_type[ new_dtype=float32\n                                                                                                                weak_type=False ]" source_file="wave_equation.py" source_line=129}
  %broadcast.440 = f32[1032,1024]{1,0} broadcast(f32[] %convert.439), dimensions={}, metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=129}
  %multiply.441 = f32[1032,1024]{1,0} multiply(f32[1032,1024]{1,0} %multiply.438, f32[1032,1024]{1,0} %broadcast.440), metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=129}
  %add.442 = f32[1032,1024]{1,0} add(f32[1032,1024]{1,0} %parameter.396, f32[1032,1024]{1,0} %multiply.441), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/add" source_file="wave_equation.py" source_line=129}
  %convert.443 = f32[] convert(f32[] %parameter.397), metadata={op_type="convert_element_type" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/convert_element_type[ new_dtype=float32\n                                                                                                                weak_type=False ]" source_file="wave_equation.py" source_line=130}
  %broadcast.444 = f32[1032,1024]{1,0} broadcast(f32[] %convert.443), dimensions={}, metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=130}
  %multiply.445 = f32[1032,1024]{1,0} multiply(f32[1032,1024]{1,0} %add.442, f32[1032,1024]{1,0} %broadcast.444), metadata={op_type="mul" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/mul" source_file="wave_equation.py" source_line=130}
  %add.446 = f32[1032,1024]{1,0} add(f32[1032,1024]{1,0} %parameter.395, f32[1032,1024]{1,0} %multiply.445), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/jit(leapfrog_step)/add" source_file="wave_equation.py" source_line=130}
  ROOT %tuple.447 = (f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(f32[1032,1024]{1,0} %add.446, f32[1032,1024]{1,0} %add.442)
}

%body_computation__2.448 (parameter.449: (f32[], s32[], s32[], s32[], f32[1032,1024], /*index=5*/f32[1032,1024])) -> (f32[], s32[], s32[], s32[], f32[1032,1024], /*index=5*/f32[1032,1024]) {
  %constant.456 = pred[] constant(false)
  %parameter.449 = (f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) parameter(0)
  %get-tuple-element.450 = f32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.449), index=0
  %get-tuple-element.451 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.449), index=1
  %get-tuple-element.452 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.449), index=2
  %constant.457 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/add" source_file="wave_equation.py" source_line=137}
  %add.458 = s32[] add(s32[] %get-tuple-element.452, s32[] %constant.457), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/add" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.453 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.449), index=3
  %get-tuple-element.454 = f32[1032,1024]{1,0} get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.449), index=4
  %get-tuple-element.455 = f32[1032,1024]{1,0} get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.449), index=5
  %call.459 = (f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) call(f32[1032,1024]{1,0} %get-tuple-element.454, f32[1032,1024]{1,0} %get-tuple-element.455, f32[] %get-tuple-element.450, s32[] %get-tuple-element.451), to_apply=%jit_leapfrog_step__1.394, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/xla_call[ backend=None\n                                                                                 device=None\n                                                                                 donated_invars=(False, False, False, False)\n                                                                                 inline=False\n                                                                                 name=leapfrog_step ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.460 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %call.459), index=0, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/xla_call[ backend=None\n                                                                                 device=None\n                                                                                 donated_invars=(False, False, False, False)\n                                                                                 inline=False\n                                                                                 name=leapfrog_step ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.461 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %call.459), index=1, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/body/xla_call[ backend=None\n                                                                                 device=None\n                                                                                 donated_invars=(False, False, False, False)\n                                                                                 inline=False\n                                                                                 name=leapfrog_step ]" source_file="wave_equation.py" source_line=137}
  ROOT %tuple.462 = (f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) tuple(f32[] %get-tuple-element.450, s32[] %get-tuple-element.451, s32[] %add.458, s32[] %get-tuple-element.453, f32[1032,1024]{1,0} %get-tuple-element.460, /*index=5*/f32[1032,1024]{1,0} %get-tuple-element.461)
}

%cond_computation__2.463 (parameter.464: (f32[], s32[], s32[], s32[], f32[1032,1024], /*index=5*/f32[1032,1024])) -> pred[] {
  %parameter.464 = (f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) parameter(0)
  %get-tuple-element.465 = f32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.464), index=0
  %get-tuple-element.466 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.464), index=1
  %get-tuple-element.469 = f32[1032,1024]{1,0} get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.464), index=4
  %get-tuple-element.470 = f32[1032,1024]{1,0} get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.464), index=5
  %constant.471 = pred[] constant(false)
  %get-tuple-element.467 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.464), index=2
  %get-tuple-element.468 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %parameter.464), index=3
  ROOT %compare.472 = pred[] compare(s32[] %get-tuple-element.467, s32[] %get-tuple-element.468), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while/cond/lt" source_file="wave_equation.py" source_line=137}
}

%jit_multi_step__2.473 (parameter.474: f32[1032,1024], parameter.475: f32[1032,1024], parameter.476: s32[], parameter.477: f32[], parameter.478: s32[]) -> (f32[1032,1024], f32[1032,1024]) {
  %constant.479 = pred[] constant(false)
  %parameter.477 = f32[] parameter(3)
  %parameter.478 = s32[] parameter(4)
  %constant.480 = s32[] constant(0), metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %parameter.476 = s32[] parameter(2)
  %parameter.474 = f32[1032,1024]{1,0} parameter(0)
  %parameter.475 = f32[1032,1024]{1,0} parameter(1)
  %tuple.481 = (f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) tuple(f32[] %parameter.477, s32[] %parameter.478, s32[] %constant.480, s32[] %parameter.476, f32[1032,1024]{1,0} %parameter.474, /*index=5*/f32[1032,1024]{1,0} %parameter.475), metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %while.482 = (f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) while((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %tuple.481), condition=%cond_computation__2.463, body=%body_computation__2.448, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.483 = f32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %while.482), index=0, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.484 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %while.482), index=1, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.485 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %while.482), index=2, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.486 = s32[] get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %while.482), index=3, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.487 = f32[1032,1024]{1,0} get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %while.482), index=4, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.488 = f32[1032,1024]{1,0} get-tuple-element((f32[], s32[], s32[], s32[], f32[1032,1024]{1,0}, /*index=5*/f32[1032,1024]{1,0}) %while.482), index=5, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %tuple.489 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(s32[] %get-tuple-element.485, s32[] %get-tuple-element.486, f32[1032,1024]{1,0} %get-tuple-element.487, f32[1032,1024]{1,0} %get-tuple-element.488), metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.490 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.489), index=0, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.491 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.489), index=1, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.492 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.489), index=2, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  %get-tuple-element.493 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.489), index=3, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while/body/jit(multi_step)/while[ body_nconsts=2\n                                                                   cond_nconsts=0 ]" source_file="wave_equation.py" source_line=137}
  ROOT %tuple.494 = (f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(f32[1032,1024]{1,0} %get-tuple-element.492, f32[1032,1024]{1,0} %get-tuple-element.493)
}

%reduction_computation.495 (parameter.496: f32[], parameter.497: f32[]) -> f32[] {
  %parameter.496 = f32[] parameter(0)
  ROOT %parameter.497 = f32[] parameter(1)
  %constant.498 = pred[] constant(false)
}

%reduction_computation__1.499 (parameter.500: f32[], parameter.501: f32[]) -> f32[] {
  %parameter.500 = f32[] parameter(0)
  ROOT %parameter.501 = f32[] parameter(1)
  %constant.502 = pred[] constant(false)
}

%reduction_computation__2.503 (parameter.504: f32[], parameter.505: f32[]) -> f32[] {
  %parameter.504 = f32[] parameter(0)
  ROOT %parameter.505 = f32[] parameter(1)
  %constant.506 = pred[] constant(false)
}

%reduction_computation__3.507 (parameter.508: f32[], parameter.509: f32[]) -> f32[] {
  %parameter.508 = f32[] parameter(0)
  ROOT %parameter.509 = f32[] parameter(1)
  %constant.510 = pred[] constant(false)
}

%body_computation__1.511 (parameter.512: (s32[], s32[], f32[1032,1024], f32[1032,1024])) -> (s32[], s32[], f32[1032,1024], f32[1032,1024]) {
  %constant.517 = pred[] constant(false)
  %constant.538 = f32[] constant(0), metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=67}
  %constant.542 = f32[] constant(0), metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=69}
  %constant.556 = f32[] constant(0), metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=67}
  %constant.560 = f32[] constant(0), metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=69}
  %parameter.512 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) parameter(0)
  %get-tuple-element.513 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.512), index=0
  %constant.562 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/add" source_file="wave_equation.py" source_line=97}
  %add.563 = s32[] add(s32[] %get-tuple-element.513, s32[] %constant.562), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/add" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.514 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.512), index=1
  %constant.518 = s32[] constant(1), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/add" source_file="wave_equation.py" source_line=152}
  %add.519 = s32[] add(s32[] %get-tuple-element.514, s32[] %constant.518), metadata={op_type="add" op_name="pmap(simulate_until_output)/scan/while/body/add" source_file="wave_equation.py" source_line=152}
  %get-tuple-element.515 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.512), index=2
  %get-tuple-element.516 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.512), index=3
  %constant.520 = s32[] constant(4), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/xla_call[ backend=None\n                                                      device=None\n                                                      donated_invars=(False, False, False, False, False)\n                                                      inline=False\n                                                      name=multi_step ]" source_file="wave_equation.py" source_line=144}
  %constant.521 = f32[] constant(0.5), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/xla_call[ backend=None\n                                                      device=None\n                                                      donated_invars=(False, False, False, False, False)\n                                                      inline=False\n                                                      name=multi_step ]" source_file="wave_equation.py" source_line=144}
  %constant.522 = s32[] constant(1), metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/xla_call[ backend=None\n                                                      device=None\n                                                      donated_invars=(False, False, False, False, False)\n                                                      inline=False\n                                                      name=multi_step ]" source_file="wave_equation.py" source_line=144}
  %call.523 = (f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) call(f32[1032,1024]{1,0} %get-tuple-element.515, f32[1032,1024]{1,0} %get-tuple-element.516, s32[] %constant.520, f32[] %constant.521, s32[] %constant.522), to_apply=%jit_multi_step__2.473, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/xla_call[ backend=None\n                                                      device=None\n                                                      donated_invars=(False, False, False, False, False)\n                                                      inline=False\n                                                      name=multi_step ]" source_file="wave_equation.py" source_line=144}
  %get-tuple-element.524 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %call.523), index=0, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/xla_call[ backend=None\n                                                      device=None\n                                                      donated_invars=(False, False, False, False, False)\n                                                      inline=False\n                                                      name=multi_step ]" source_file="wave_equation.py" source_line=144}
  %constant.536 = s32[] constant(0), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=67}
  %broadcast.537 = s32[1]{0} broadcast(s32[] %constant.536), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=67}
  %constant.530 = s32[] constant(1024), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.531 = s32[1]{0} broadcast(s32[] %constant.530), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.532 = f32[4,1024]{1,0} gather(f32[1032,1024]{1,0} %get-tuple-element.524, s32[1]{0} %broadcast.531), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                                    indices_are_sorted=True\n                                                    slice_sizes=(4, 1024)\n                                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.533 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.532), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.535 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.533), source_target_pairs={{0,1},{1,2},{2,3},{3,4},{4,5},{5,6},{6,7}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/scan/while/body/ppermute[ axis_name=x\n                                                      perm=((0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)) ]" source_file="wave_equation.py" source_line=31}
  %scatter.539 = f32[1032,1024]{1,0} scatter(f32[1032,1024]{1,0} %get-tuple-element.524, s32[1]{0} %broadcast.537, f32[4,1024]{1,0} %collective-permute.535), update_window_dims={0,1}, inserted_window_dims={}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, unique_indices=true, to_apply=%reduction_computation.495, metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=67}
  %constant.540 = s32[] constant(1028), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=69}
  %broadcast.541 = s32[1]{0} broadcast(s32[] %constant.540), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=69}
  %constant.526 = s32[] constant(4), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.527 = s32[1]{0} broadcast(s32[] %constant.526), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.528 = f32[4,1024]{1,0} gather(f32[1032,1024]{1,0} %get-tuple-element.524, s32[1]{0} %broadcast.527), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                                    indices_are_sorted=True\n                                                    slice_sizes=(4, 1024)\n                                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.529 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.528), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.534 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.529), source_target_pairs={{1,0},{2,1},{3,2},{4,3},{5,4},{6,5},{7,6}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/scan/while/body/ppermute[ axis_name=x\n                                                      perm=((1, 0), (2, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6)) ]" source_file="wave_equation.py" source_line=35}
  %scatter.543 = f32[1032,1024]{1,0} scatter(f32[1032,1024]{1,0} %scatter.539, s32[1]{0} %broadcast.541, f32[4,1024]{1,0} %collective-permute.534), update_window_dims={0,1}, inserted_window_dims={}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, unique_indices=true, to_apply=%reduction_computation__1.499, metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=69}
  %get-tuple-element.525 = f32[1032,1024]{1,0} get-tuple-element((f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %call.523), index=1, metadata={op_type="xla_call" op_name="pmap(simulate_until_output)/scan/while/body/xla_call[ backend=None\n                                                      device=None\n                                                      donated_invars=(False, False, False, False, False)\n                                                      inline=False\n                                                      name=multi_step ]" source_file="wave_equation.py" source_line=144}
  %constant.554 = s32[] constant(0), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=67}
  %broadcast.555 = s32[1]{0} broadcast(s32[] %constant.554), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=67}
  %constant.548 = s32[] constant(1024), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.549 = s32[1]{0} broadcast(s32[] %constant.548), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.550 = f32[4,1024]{1,0} gather(f32[1032,1024]{1,0} %get-tuple-element.525, s32[1]{0} %broadcast.549), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                                    indices_are_sorted=True\n                                                    slice_sizes=(4, 1024)\n                                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.551 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.550), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.553 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.551), source_target_pairs={{0,1},{1,2},{2,3},{3,4},{4,5},{5,6},{6,7}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/scan/while/body/ppermute[ axis_name=x\n                                                      perm=((0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)) ]" source_file="wave_equation.py" source_line=31}
  %scatter.557 = f32[1032,1024]{1,0} scatter(f32[1032,1024]{1,0} %get-tuple-element.525, s32[1]{0} %broadcast.555, f32[4,1024]{1,0} %collective-permute.553), update_window_dims={0,1}, inserted_window_dims={}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, unique_indices=true, to_apply=%reduction_computation__2.503, metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=67}
  %constant.558 = s32[] constant(1028), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=69}
  %broadcast.559 = s32[1]{0} broadcast(s32[] %constant.558), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=69}
  %constant.544 = s32[] constant(4), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.545 = s32[1]{0} broadcast(s32[] %constant.544), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(  )\n                                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.546 = f32[4,1024]{1,0} gather(f32[1032,1024]{1,0} %get-tuple-element.525, s32[1]{0} %broadcast.545), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/scan/while/body/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                                    indices_are_sorted=True\n                                                    slice_sizes=(4, 1024)\n                                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.547 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.546), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/scan/while/body/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.552 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.547), source_target_pairs={{1,0},{2,1},{3,2},{4,3},{5,4},{6,5},{7,6}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/scan/while/body/ppermute[ axis_name=x\n                                                      perm=((1, 0), (2, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6)) ]" source_file="wave_equation.py" source_line=35}
  %scatter.561 = f32[1032,1024]{1,0} scatter(f32[1032,1024]{1,0} %scatter.557, s32[1]{0} %broadcast.559, f32[4,1024]{1,0} %collective-permute.552), update_window_dims={0,1}, inserted_window_dims={}, scatter_dims_to_operand_dims={0}, index_vector_dim=0, unique_indices=true, to_apply=%reduction_computation__3.507, metadata={op_type="scatter" op_name="pmap(simulate_until_output)/scan/while/body/scatter[ dimension_numbers=ScatterDimensionNumbers(update_window_dims=(0, 1), inserted_window_dims=(), scatter_dims_to_operand_dims=(0,))\n                                                     indices_are_sorted=False\n                                                     unique_indices=True\n                                                     update_consts=(  ) ]" source_file="wave_equation.py" source_line=69}
  ROOT %tuple.564 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(s32[] %add.563, s32[] %add.519, f32[1032,1024]{1,0} %scatter.543, f32[1032,1024]{1,0} %scatter.561)
}

%cond_computation__1.565 (parameter.566: (s32[], s32[], f32[1032,1024], f32[1032,1024])) -> pred[] {
  %parameter.566 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) parameter(0)
  %get-tuple-element.568 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.566), index=1
  %get-tuple-element.569 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.566), index=2
  %get-tuple-element.570 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.566), index=3
  %constant.571 = pred[] constant(false)
  %get-tuple-element.567 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %parameter.566), index=0
  %constant.572 = s32[] constant(8192), metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/cond/lt" source_file="wave_equation.py" source_line=97}
  ROOT %compare.573 = pred[] compare(s32[] %get-tuple-element.567, s32[] %constant.572), direction=LT, metadata={op_type="lt" op_name="pmap(simulate_until_output)/scan/while/cond/lt" source_file="wave_equation.py" source_line=97}
}

ENTRY %pmap_simulate_until_output.597 (parameter.1: f32[1024,1024], parameter.2: f32[1024,1024]) -> (f32[1024,1024], f32[1024,1024]) {
  %constant.3 = pred[] constant(false)
  %constant.27 = pred[] constant(false), metadata={op_type="scan" op_name="pmap(simulate_until_output)/scan[ length=8192\n                                  linear=(False, False, False)\n                                  num_carry=3\n                                  num_consts=0\n                                  reverse=False\n                                  unroll=1 ]" source_file="wave_equation.py" source_line=152}
  %constant.28 = s32[] constant(0), metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %constant.26 = s32[] constant(0), metadata={op_type="scan" op_name="pmap(simulate_until_output)/scan[ length=8192\n                                  linear=(False, False, False)\n                                  num_carry=3\n                                  num_consts=0\n                                  reverse=False\n                                  unroll=1 ]" source_file="wave_equation.py" source_line=152}
  %parameter.1 = f32[1024,1024]{1,0} parameter(0), parameter_replication={false}
  %constant.8 = s32[] constant(1020), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.9 = s32[1]{0} broadcast(s32[] %constant.8), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.10 = f32[4,1024]{1,0} gather(f32[1024,1024]{1,0} %parameter.1, s32[1]{0} %broadcast.9), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                    indices_are_sorted=True\n                                    slice_sizes=(4, 1024)\n                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.11 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.10), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.13 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.11), source_target_pairs={{0,1},{1,2},{2,3},{3,4},{4,5},{5,6},{6,7}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/ppermute[ axis_name=x\n                                      perm=((0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)) ]" source_file="wave_equation.py" source_line=31}
  %constant.4 = s32[] constant(0), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.5 = s32[1]{0} broadcast(s32[] %constant.4), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.6 = f32[4,1024]{1,0} gather(f32[1024,1024]{1,0} %parameter.1, s32[1]{0} %broadcast.5), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                    indices_are_sorted=True\n                                    slice_sizes=(4, 1024)\n                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.7 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.6), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.12 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.7), source_target_pairs={{1,0},{2,1},{3,2},{4,3},{5,4},{6,5},{7,6}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/ppermute[ axis_name=x\n                                      perm=((1, 0), (2, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6)) ]" source_file="wave_equation.py" source_line=35}
  %concatenate.14 = f32[1032,1024]{1,0} concatenate(f32[4,1024]{1,0} %collective-permute.13, f32[1024,1024]{1,0} %parameter.1, f32[4,1024]{1,0} %collective-permute.12), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=60}
  %parameter.2 = f32[1024,1024]{1,0} parameter(1), parameter_replication={false}
  %constant.19 = s32[] constant(1020), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.20 = s32[1]{0} broadcast(s32[] %constant.19), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.21 = f32[4,1024]{1,0} gather(f32[1024,1024]{1,0} %parameter.2, s32[1]{0} %broadcast.20), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                    indices_are_sorted=True\n                                    slice_sizes=(4, 1024)\n                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.22 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.21), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.24 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.22), source_target_pairs={{0,1},{1,2},{2,3},{3,4},{4,5},{5,6},{6,7}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/ppermute[ axis_name=x\n                                      perm=((0, 1), (1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)) ]" source_file="wave_equation.py" source_line=31}
  %constant.15 = s32[] constant(0), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %broadcast.16 = s32[1]{0} broadcast(s32[] %constant.15), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=43}
  %gather.17 = f32[4,1024]{1,0} gather(f32[1024,1024]{1,0} %parameter.2, s32[1]{0} %broadcast.16), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={4,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                    indices_are_sorted=True\n                                    slice_sizes=(4, 1024)\n                                    unique_indices=True ]" source_file="wave_equation.py" source_line=43}
  %broadcast.18 = f32[4,1024]{1,0} broadcast(f32[4,1024]{1,0} %gather.17), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                              shape=(4, 1024) ]" source_file="wave_equation.py" source_line=43}
  %collective-permute.23 = f32[4,1024]{1,0} collective-permute(f32[4,1024]{1,0} %broadcast.18), source_target_pairs={{1,0},{2,1},{3,2},{4,3},{5,4},{6,5},{7,6}}, metadata={op_type="ppermute" op_name="pmap(simulate_until_output)/ppermute[ axis_name=x\n                                      perm=((1, 0), (2, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6)) ]" source_file="wave_equation.py" source_line=35}
  %concatenate.25 = f32[1032,1024]{1,0} concatenate(f32[4,1024]{1,0} %collective-permute.24, f32[1024,1024]{1,0} %parameter.2, f32[4,1024]{1,0} %collective-permute.23), dimensions={0}, metadata={op_type="concatenate" op_name="pmap(simulate_until_output)/concatenate[ dimension=0 ]" source_file="wave_equation.py" source_line=60}
  %tuple.29 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(s32[] %constant.28, s32[] %constant.26, f32[1032,1024]{1,0} %concatenate.14, f32[1032,1024]{1,0} %concatenate.25), metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %while.574 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) while((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.29), condition=%cond_computation__1.565, body=%body_computation__1.511, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.575 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %while.574), index=0, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.576 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %while.574), index=1, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.577 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %while.574), index=2, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.578 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %while.574), index=3, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %tuple.579 = (s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(s32[] %get-tuple-element.575, s32[] %get-tuple-element.576, f32[1032,1024]{1,0} %get-tuple-element.577, f32[1032,1024]{1,0} %get-tuple-element.578), metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.580 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.579), index=0, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.581 = s32[] get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.579), index=1, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.582 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.579), index=2, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %get-tuple-element.583 = f32[1032,1024]{1,0} get-tuple-element((s32[], s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.579), index=3, metadata={op_type="while" op_name="pmap(simulate_until_output)/scan/while[ body_nconsts=0\n                                        cond_nconsts=0 ]" source_file="wave_equation.py" source_line=97}
  %tuple.584 = (s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) tuple(s32[] %get-tuple-element.581, f32[1032,1024]{1,0} %get-tuple-element.582, f32[1032,1024]{1,0} %get-tuple-element.583)
  %get-tuple-element.585 = s32[] get-tuple-element((s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.584), index=0
  %get-tuple-element.586 = f32[1032,1024]{1,0} get-tuple-element((s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.584), index=1
  %constant.588 = s32[] constant(4), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=155}
  %broadcast.589 = s32[1]{0} broadcast(s32[] %constant.588), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=155}
  %gather.590 = f32[1024,1024]{1,0} gather(f32[1032,1024]{1,0} %get-tuple-element.586, s32[1]{0} %broadcast.589), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={1024,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                    indices_are_sorted=True\n                                    slice_sizes=(1024, 1024)\n                                    unique_indices=True ]" source_file="wave_equation.py" source_line=155}
  %broadcast.591 = f32[1024,1024]{1,0} broadcast(f32[1024,1024]{1,0} %gather.590), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                              shape=(1024, 1024) ]" source_file="wave_equation.py" source_line=155}
  %get-tuple-element.587 = f32[1032,1024]{1,0} get-tuple-element((s32[], f32[1032,1024]{1,0}, f32[1032,1024]{1,0}) %tuple.584), index=2
  %constant.592 = s32[] constant(4), metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=155}
  %broadcast.593 = s32[1]{0} broadcast(s32[] %constant.592), dimensions={}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(  )\n                                              shape=(1,) ]" source_file="wave_equation.py" source_line=155}
  %gather.594 = f32[1024,1024]{1,0} gather(f32[1032,1024]{1,0} %get-tuple-element.587, s32[1]{0} %broadcast.593), offset_dims={0,1}, collapsed_slice_dims={}, start_index_map={0}, index_vector_dim=0, slice_sizes={1024,1024}, indices_are_sorted=true, metadata={op_type="gather" op_name="pmap(simulate_until_output)/gather[ dimension_numbers=GatherDimensionNumbers(offset_dims=(0, 1), collapsed_slice_dims=(), start_index_map=(0,))\n                                    indices_are_sorted=True\n                                    slice_sizes=(1024, 1024)\n                                    unique_indices=True ]" source_file="wave_equation.py" source_line=155}
  %broadcast.595 = f32[1024,1024]{1,0} broadcast(f32[1024,1024]{1,0} %gather.594), dimensions={0,1}, metadata={op_type="broadcast_in_dim" op_name="pmap(simulate_until_output)/broadcast_in_dim[ broadcast_dimensions=(0, 1)\n                                              shape=(1024, 1024) ]" source_file="wave_equation.py" source_line=155}
  ROOT %tuple.596 = (f32[1024,1024]{1,0}, f32[1024,1024]{1,0}) tuple(f32[1024,1024]{1,0} %broadcast.591, f32[1024,1024]{1,0} %broadcast.595)
}

